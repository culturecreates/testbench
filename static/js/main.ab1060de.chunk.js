(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{246:function(e,t,n){e.exports=n(622)},251:function(e,t,n){},253:function(e,t,n){},622:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(17),s=n.n(i),o=(n(251),n(8)),c=n(9),l=n(12),p=n(11),u=n(13),h=(n(252),n(253),n(239)),d=n.n(h),m=n(62),y=n.n(m),f=n(18),g=n.n(f),v=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="",t="",n="inherit",a="featureCell-default";!0===this.props.value?(e="glyphicon glyphicon-ok",t="available",n="green",a="featureCell-green"):!1===this.props.value?(e="glyphicon glyphicon-remove",t="unavailable",n="#c00000",a="featureCell-red"):"checking"===this.props.value?(e="glyphicon glyphicon-hourglass",t="fetching..."):"maybe"===this.props.value&&(e="glyphicon glyphicon-search",t="Not reachable via CORS, click to check via JSONP",a="featureCell-yellow");var i=r.a.createElement("span",{className:e,"sr-only":t,style:{color:n}}),s=i;return this.props.onClick&&"maybe"===this.props.value&&(s=r.a.createElement(g.a,{onClick:this.props.onClick,bsStyle:"warning",bsSize:"xsmall",title:"Check with JSONP"},i)),r.a.createElement("td",{className:"featureCell "+a},s)}}]),t}(r.a.Component),E=n(53),b=n.n(E),S=function(e,t){var n=new URL(e);return t&&Object.keys(t).forEach(function(e){return n.searchParams.append(e,t[e])}),n.toString()},k=function(e,t){return b()(S(e,t),{timeout:2e4})},w=function(e,t){return fetch(S(e,t))},C=function(){function e(t,n,a){Object(o.a)(this,e),this.endpoint=t,this.manifest=n,this.cors=a}return Object(c.a)(e,[{key:"getFetcher",value:function(){return this.cors?w:k}}]),e}(),O=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(p.a)(t).call(this))).checkJsonp=function(){e.setState({reacheableJSONP:"checking"}),b()(e.props.endpoint).then(function(e){return e.json()}).then(function(t){return e.setState({manifest:t,reacheableJSONP:!0})}).catch(function(t){return e.setState({reacheableJSONP:!1})})},e.triggerOnSelect=function(){e.props.onSelect&&e.props.onSelect(new C(e.props.endpoint,e.state.manifest,e.state.reacheableCORS))},e.state={reacheableCORS:"checking",reacheableJSONP:"maybe",manifest:{}},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch(this.props.endpoint,{timeout:5e3}).then(function(e){return e.json()}).then(function(t){return e.setState({manifest:t,reacheableCORS:!0})}).catch(function(t){e.setState({reacheableCORS:!1})}),this.props.jsonp&&this.checkJsonp()}},{key:"suggestSettings",value:function(){return this.state.manifest.suggest||{}}},{key:"hasView",value:function(){return this.isReacheable?"url"in(this.state.manifest.view||{}):null}},{key:"hasSuggestEntity",value:function(){return this.isReacheable?"entity"in this.suggestSettings():null}},{key:"hasSuggestProperty",value:function(){return this.isReacheable?"property"in this.suggestSettings():null}},{key:"hasSuggestType",value:function(){return this.isReacheable?"type"in this.suggestSettings():null}},{key:"hasPreview",value:function(){return this.isReacheable?"preview"in this.state.manifest:null}},{key:"hasExtend",value:function(){return this.isReacheable?"extend"in this.state.manifest:null}},{key:"nameCell",value:function(){var e=[r.a.createElement("span",{key:"name"},this.props.name)];return this.props.documentation&&!this.props.source_url&&e.push(r.a.createElement("span",{key:"docs"}," (",r.a.createElement("a",{href:this.props.documentation,target:"_blank",rel:"noopener noreferrer",title:"Read endpoint documentation"},"docs"),")")),this.props.documentation&&this.props.source_url&&e.push(r.a.createElement("span",{key:"docs"}," (",r.a.createElement("a",{href:this.props.documentation,target:"_blank",rel:"noopener noreferrer",title:"Read endpoint documentation"},"docs"),", ",r.a.createElement("a",{href:this.props.source_url,target:"_blank",rel:"noopener noreferrer",title:"View endpoint source code"},"source"),")")),!this.props.documentation&&this.props.source_url&&e.push(r.a.createElement("span",{key:"docs"}," (",r.a.createElement("a",{href:this.props.source_url,target:"_blank",rel:"noopener noreferrer",title:"View endpoint source code"},"source"),")")),this.props.wd_uri&&e.push(r.a.createElement("span",{key:"wd",style:{float:"right"}},r.a.createElement("a",{href:this.props.wd_uri+"#P6269",target:"_blank",rel:"noopener noreferrer",title:"Edit on Wikidata"},r.a.createElement("span",{className:"glyphicon glyphicon-pencil"})))),e}},{key:"render",value:function(){return r.a.createElement("tr",null,r.a.createElement("td",null,this.nameCell()),r.a.createElement("td",null,r.a.createElement(g.a,{bsStyle:"primary",bsSize:"xsmall",onClick:this.triggerOnSelect,title:"Use in test bench",disabled:!this.isReacheable},r.a.createElement("span",{className:"glyphicon glyphicon-play"}))," ",r.a.createElement("a",{href:this.props.endpoint,target:"_blank",rel:"noopener noreferrer"},this.props.endpoint)),r.a.createElement(v,{value:this.state.reacheableCORS}),r.a.createElement(v,{value:this.state.reacheableJSONP,onClick:this.checkJsonp}),r.a.createElement(v,{value:this.hasView()}),r.a.createElement(v,{value:this.hasSuggestEntity()}),r.a.createElement(v,{value:this.hasSuggestType()}),r.a.createElement(v,{value:this.hasSuggestProperty()}),r.a.createElement(v,{value:this.hasPreview()}),r.a.createElement(v,{value:this.hasExtend()}))}},{key:"isReacheable",get:function(){return!0===this.state.reacheableCORS||!0===this.state.reacheableJSONP}}]),t}(r.a.Component),T=function(){function e(t,n,a,r,i){Object(o.a)(this,e),this.endpoint=t,this.name=n,this.documentation=a,this.source_url=r,this.wd_uri=i,this.jsonp=!1}return Object(c.a)(e,[{key:"useJsonp",value:function(){this.jsonp=!0}}]),e}(),j=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(p.a)(t).call(this))).refreshServicesFromWD=function(t){e.setState({refreshing:!0});var n=new URL("https://query.wikidata.org/sparql"),a={query:e.sparql_query,format:"json"},r=null;if("GET"===t)Object.keys(a).forEach(function(e){return n.searchParams.append(e,a[e])}),r=fetch(n);else{var i=new URLSearchParams;Object.keys(a).forEach(function(e){return i.append(e,a[e])}),r=fetch(n,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i})}r.then(function(e){return e.json()}).then(function(t){return e.setState({services:t.results.bindings.map(function(e){return new T(e.endpoint.value,e.serviceLabel.value,"documentation"in e?e.documentation.value:void 0,"source"in e?e.source.value:void 0,e.service.value)}),refreshing:!1})}).catch(function(t){console.log(t),e.setState({refreshing:!1})})},e.loadAllJsonp=function(){e.setState({services:e.state.services.map(function(e){return e.useJsonp(),e})})},e.openAddServiceDialog=function(){e.setState({showAddServiceDialog:!0})},e.closeAddServiceDialog=function(){e.setState({showAddServiceDialog:!1})},e.state={services:[],showAddServiceDialog:!1,refreshing:!1},e.sparql_query='SELECT ?service ?serviceLabel ?endpoint ?documentation ?source WHERE {\n  ?service p:P6269 ?statement.\n  ?statement ps:P6269 ?endpoint ;\n     pq:P2700 wd:Q64490175.\n  OPTIONAL { ?statement (pq:P973 | pq:P2078) ?documentation }\n  OPTIONAL { ?statement pq:P1324 ?source }\n  FILTER NOT EXISTS { ?statement wikibase:rank wikibase:DeprecatedRank }\n  SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }\n}\nORDER BY DESC(?endpoint)\n',e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.refreshServicesFromWD("GET")}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Due to ",r.a.createElement("a",{href:"https://en.wikipedia.org/wiki/JSONP#Security_concerns"},"a security risk inherent to JSONP"),", only endpoints supporting ",r.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Cross-origin_resource_sharing"},"CORS")," are loaded by default. You can click the"," ",r.a.createElement("span",{className:"glyphicon glyphicon-search"})," button in each row to attempt to load the service via ",r.a.createElement("a",{href:"https://en.wikipedia.org/wiki/JSONP"},"JSONP"),". Note that a malicious endpoint could use JSONP to execute arbitrary JavaScript code in this page. If you trust all the reconciliation services listed here, you can also ",r.a.createElement(g.a,{onClick:this.loadAllJsonp,bsSize:"xsmall"},"load all endpoints via JSONP"),"."),r.a.createElement(d.a,{striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Name"),r.a.createElement("td",null,"Endpoint"),r.a.createElement("td",null,"CORS"),r.a.createElement("td",null,"JSONP"),r.a.createElement("td",null,"View entities"),r.a.createElement("td",null,"Suggest entities"),r.a.createElement("td",null,"Suggest types"),r.a.createElement("td",null,"Suggest properties"),r.a.createElement("td",null,"Preview entities"),r.a.createElement("td",null,"Extend data"))),r.a.createElement("tbody",null,this.state.services.map(function(t){return r.a.createElement(O,{endpoint:t.endpoint,name:t.name,documentation:t.documentation,source_url:t.source_url,wd_uri:t.wd_uri,jsonp:t.jsonp,onSelect:e.props.onSelect,key:t.wd_uri+" "+t.endpoint+(t.jsonp?" jsonp":" cors")})}))),r.a.createElement(g.a,{onClick:this.openAddServiceDialog},r.a.createElement("span",{className:"glyphicon glyphicon-plus"})," Add a service"),"\xa0\xa0\xa0",r.a.createElement(g.a,{onClick:function(){return e.refreshServicesFromWD("POST")},disabled:this.state.refreshing},r.a.createElement("span",{className:"glyphicon glyphicon-refresh"})," ",this.state.refreshing?"Refreshing\u2026":"Refresh table"),r.a.createElement(y.a,{show:this.state.showAddServiceDialog,onHide:this.closeAddServiceDialog},r.a.createElement(y.a.Header,{closeButton:!0},r.a.createElement(y.a.Title,null,"How to add a service to this list")),r.a.createElement(y.a.Body,null,r.a.createElement("p",null,"This list is generated by ",r.a.createElement("a",{href:this.sparqlQueryUrl},"a SPARQL query on Wikidata"),". To add your service to it, follow these steps:"),r.a.createElement("ul",null,r.a.createElement("li",null,"Make sure your service is publicly accessible - local endpoints (such as those with ",r.a.createElement("code",null,"localhost")," or ",r.a.createElement("code",null,"127.0.0.1")," in their address) should not be added to this table."),r.a.createElement("li",null,"Find out if there is already a Wikidata item about your service, your database or your identifier. You can use ",r.a.createElement("a",{href:"https://www.wikidata.org/wiki/Special:Search?ns0=1"},"Wikidata's search interface")," for that. If there is not, you can ",r.a.createElement("a",{href:"https://www.wikidata.org/wiki/Special:NewItem"},"create a new one"),"."),r.a.createElement("li",null,"Add a statement on that item, using the ",r.a.createElement("a",{href:"https://www.wikidata.org/wiki/Property:P6269"},"API endpoint (P6269)")," property, adding the ",r.a.createElement("a",{href:"https://www.wikidata.org/wiki/Q64490175"},"OpenRefine reconciliation service API (Q64490175)")," as ",r.a.createElement("a",{href:"https://www.wikidata.org/wiki/Property:P2700"},"protocol (P2700)")," in a qualifier. You can also add a link to the documentation for the endpoint by adding a ",r.a.createElement("a",{href:"https://www.wikidata.org/wiki/Property:P2078"},"user manual link (P2078)")," or ",r.a.createElement("a",{href:"https://www.wikidata.org/wiki/Property:P973"},"described at URL (P973)")," qualifier. See ",r.a.createElement("a",{href:"https://www.wikidata.org/wiki/Q922063#P6269"},"this example for how it is done"),"."),r.a.createElement("li",null,"Refresh this table - it might take a few minutes before your service appears in the table.")))))}},{key:"sparqlQueryUrl",get:function(){return"https://query.wikidata.org/#"+encodeURIComponent(this.sparql_query)}}]),t}(r.a.Component),R=n(88),P=n.n(R),N=n(33),_=n.n(N),q=n(61),A=n.n(q),I=n(26),L=n.n(I),x=n(32),D=n.n(x),J=n(27),U=n.n(J),V=n(240),Q=n.n(V),M=n(10),B=n.n(M),F=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={service:n.props.initialService},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.timer=null}},{key:"setService",value:function(e){this.setState({service:e})}},{key:"handleChange",value:function(e){var t=this;clearTimeout(this.timer),this.setState({service:new C(e.target.value,void 0,void 0),error:void 0}),this.timer=setTimeout(function(){return t.validateEndpoint()},1e3)}},{key:"validateEndpoint",value:function(){var e=this,t=this.state.service.endpoint;fetch(t).then(function(e){return e.json()}).then(function(n){return e._setService(t,n,!0)}).catch(function(n){return b()(t).then(function(e){return e.json()}).then(function(n){return e._setService(t,n,!1)}).catch(function(n){return e._setError(t,n)})})}},{key:"_setService",value:function(e,t,n){if(this.state.service.endpoint===e){var a=new C(e,t,n);this.setState({service:a}),void 0!==this.props.onChange&&this.props.onChange(a)}}},{key:"_setError",value:function(e,t){this.state.service.endpoint===e&&(this.setState({manifest:void 0,error:t}),void 0!==this.props.onChange&&this.props.onChange(void 0,void 0))}},{key:"getValidationState",value:function(){return void 0!==this.state.service&&void 0!==this.state.service.manifest?"success":void 0!==this.state.error?"error":null}},{key:"getMessage",value:function(){var e="";if("error"===this.getValidationState()){e="The endpoint MUST return a JSON document describing the service, accessible v\xeea CORS or JSONP.";var t=this.state.service.endpoint;return void 0===t||!t.startsWith("http://")||t.startsWith("http://localhost")||t.startsWith("http://127.0.0.1")||(e+=" The endpoint SHOULD be available over HTTPS. Depending on your browser, this test bench might not be able to test reconciliation services over HTTP."),e}}},{key:"handleSubmit",value:function(e){clearTimeout(this.timer),this.validateEndpoint(),e.preventDefault()}},{key:"render",value:function(){var e=this;return r.a.createElement(A.a,{horizontal:!0,onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(L.a,{controlId:"endpointField",validationState:this.getValidationState()},r.a.createElement(B.a,{componentClass:U.a,sm:1},"Endpoint:"),r.a.createElement(B.a,{sm:11},r.a.createElement(D.a,{type:"text",value:this.state.service.endpoint,placeholder:"URL of the reconciliation service endpoint",onChange:function(t){return e.handleChange(t)}}),r.a.createElement(D.a.Feedback,null),r.a.createElement(Q.a,null,this.getMessage()))))}}]),t}(r.a.Component),W=n(143),H=n.n(W),$=n(144),z=n.n($),K=n(89),Y=n.n(K),G=n(245),X=n.n(G),Z=n(241),ee=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(p.a)(t).call(this))).onSuggestionsFetchRequested=function(t){var n=e.getUrl(),a={prefix:t};null!==n&&(e.setState({isLoading:!0}),e.props.service.getFetcher()(n,a).then(function(e){return e.json()}).then(function(t){e.setState({suggestions:t.result,isLoading:!1})}).catch(function(t){console.log(t),e.setState({isLoading:!1})}))},e.onSuggestionsClearRequested=function(){e.setState({suggestions:[]})},e.onChange=function(t){void 0===e.props.onChange?e.setState({value:t[0]}):e.props.onChange(t[0])},e.state={value:void 0,suggestions:[],isLoading:!1},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"getValue",value:function(){return void 0!==this.props.onChange?this.props.value:this.state.value}},{key:"getUrl",value:function(){if(!this.manifest||!this.manifest.suggest)return null;var e=this.manifest.suggest[this.props.entityClass];return e?e.service_url+e.service_path:null}},{key:"render",value:function(){return r.a.createElement(Z.AsyncTypeahead,{id:this.props.id,disabled:null===this.getUrl(),isLoading:this.state.isLoading,onSearch:this.onSuggestionsFetchRequested,options:this.state.suggestions,labelKey:"name",filterBy:function(e,t){return!0},selected:this.getValue()?[this.getValue()]:[],onChange:this.onChange,renderMenuItemChildren:function(e,t,n){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"suggestItemId"},e.id),r.a.createElement("span",{className:"suggestItemLabel"},e.name),r.a.createElement("br",null),r.a.createElement("span",{className:"suggestItemDescription"},e.description))}})}},{key:"manifest",get:function(){return this.props.service?this.props.service.manifest:null}}]),t}(r.a.Component),te=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).newMapping=function(){n.emitChange(n.props.value.concat([{property:void 0,value:""}]))},n.deleteMapping=function(e){var t=n.props.value.slice();t.splice(e,1),n.emitChange(t)},n.onValueChange=function(e,t){var a=n.props.value.slice(),r=a[e].property;a[e]={property:r,value:t.currentTarget.value},n.emitChange(a)},n.onPropertyChange=function(e,t){console.log("new property value"),console.log(e),console.log(t);var a=n.props.value.slice(),r=a[e].value;a[e]={property:t,value:r},console.log(a),n.emitChange(a)},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"emitChange",value:function(e){this.props.onChange&&this.props.onChange(e)}},{key:"renderMappings",value:function(){var e=this;return this.props.value.map(function(t,n){return r.a.createElement("div",{style:{display:"inline-block",marginBottom:"5px"},key:n},r.a.createElement("div",{style:{display:"inline-block",width:"45%"}},r.a.createElement(ee,{service:e.props.service,entityClass:"property",id:"mapping-property-"+n,value:t.property,onChange:function(t){return e.onPropertyChange(n,t)}})),r.a.createElement("div",{style:{display:"inline-block",width:"45%"}},r.a.createElement(D.a,{type:"text",placeholder:"Type a value",value:t.value||"",onChange:function(t){return e.onValueChange(n,t)}})),r.a.createElement(g.a,{bsStyle:"primary",bsSize:"xsmall",onClick:function(){return e.deleteMapping(n)},title:"delete property"},r.a.createElement("span",{className:"glyphicon glyphicon-trash"})))})}},{key:"render",value:function(){return r.a.createElement("div",null,this.renderMappings(),r.a.createElement("br",null),r.a.createElement(g.a,{onClick:this.newMapping},"Add property"))}}]),t}(r.a.Component),ne=n(242),ae=n.n(ne),re=n(142),ie=n.n(re),se=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"renderDescription",value:function(){var e=this.props.candidate.description;return void 0!==e?r.a.createElement("span",null,r.a.createElement("br",null),e):r.a.createElement("span",null)}},{key:"renderTypes",value:function(){var e=this.props.candidate.type;if(void 0!==e)return r.a.createElement("span",null,r.a.createElement("br",null),e.map(function(e,t){return[t>0&&", ",e.name+" ("+e.id+")"]}))}},{key:"render",value:function(){var e=this.props.candidate;return r.a.createElement(ie.a,{key:e.id,header:e.name,active:e.match},r.a.createElement("a",{href:this.url},e.id),r.a.createElement(ae.a,{style:{float:"right"}},this.props.candidate.score),this.renderDescription(),this.renderTypes())}},{key:"url",get:function(){var e=null;return"view"in this.props.manifest&&"url"in this.props.manifest.view&&"id"in this.props.candidate&&(e=this.props.manifest.view.url.replace("{{id}}",this.props.candidate.id)),e}}]),t}(r.a.Component),oe=n(243),ce=n.n(oe),le=n(244),pe=n.n(le),ue={$schema:"http://json-schema.org/schema#",$id:"https://reconciliation-api.github.io/specs/latest/schemas/manifest.json",type:"object",description:"This validates a service manifest, describing the features supported by the endpoint.",properties:{versions:{type:"array",description:"The list of API versions supported by this service.",items:{type:"string"},contains:{enum:["0.2"]}},name:{type:"string",description:"A human-readable name for the service or data source"},identifierSpace:{type:"string",description:"A URI describing the entity identifiers used in this service"},schemaSpace:{type:"string",description:"A URI describing the schema used in this service"},view:{type:"object",properties:{url:{type:"string",description:"A template to transform an entity identifier into the corresponding URI",pattern:".*\\{\\{id\\}\\}.*"}},required:["url"]},feature_view:{type:"object",properties:{url:{type:"string",description:"A template to transform a matching feature identifier into the corresponding URI",pattern:".*\\{\\{id\\}\\}.*"}},required:["url"]},defaultTypes:{type:"array",description:"A list of default types that are considered good generic choices for reconciliation",items:{type:"object",properties:{id:{type:"string"},name:{type:"string"}},required:["id","name"]},uniqueItems:!0},suggest:{type:"object",description:"Settings for the suggest protocol, to auto-complete entities, properties and types",definitions:{service_definition:{type:"object",properties:{service_url:{type:"string"},service_path:{type:"string"},flyout_service_url:{type:"string"},flyout_service_path:{type:"string",pattern:".*\\$\\{id\\}.*"}},required:[]}},properties:{entity:{$ref:"#/properties/suggest/definitions/service_definition"},property:{$ref:"#/properties/suggest/definitions/service_definition"},type:{$ref:"#/properties/suggest/definitions/service_definition"}}},preview:{type:"object",description:"Settings for the preview protocol, for HTML previews of entities",properties:{url:{type:"string",pattern:".*\\{\\{id\\}\\}.*",description:"A URL pattern which transforms the entity ID into a preview URL for it"},width:{type:"integer",description:"The width of the iframe where to include the HTML preview"},height:{type:"integer",description:"The height of the iframe where to include the HTML preview"}},required:["url","width","height"]},extend:{type:"object",description:"Settings for the data extension protocol, to fetch property values",properties:{propose_properties:{type:"object",description:"Location of the endpoint to propose properties to fetch for a given type",properties:{service_url:{type:"string"},service_path:{type:"string"}}},property_settings:{type:"array",description:"Definition of the settings configurable by the user when fetching a property",items:{oneOf:[{type:"object",description:"Defines a numerical setting on a property",properties:{type:{type:"string",enum:["number"]},default:{type:"number"},label:{type:"string"},name:{type:"string"},help_text:{type:"string"}},required:["type","label","name"]},{type:"object",description:"Defines a string setting on a property",properties:{type:{type:"string",enum:["text"]},default:{type:"string"},label:{type:"string"},name:{type:"string"},help_text:{type:"string"}},required:["type","label","name"]},{type:"object",description:"Defines a boolean setting on a property",properties:{type:{type:"string",enum:["checkbox"]},default:{type:"boolean"},label:{type:"string"},name:{type:"string"},help_text:{type:"string"}},required:["type","label","name"]},{type:"object",description:"Defines a setting with a fixed set of choices",properties:{type:{type:"string",enum:["select"]},default:{type:"string"},label:{type:"string"},name:{type:"string"},help_text:{type:"string"},choices:{type:"array",items:{type:"object",properties:{value:{type:"string"},name:{type:"string"}},required:["value","name"]}}},required:["type","label","name","choices"]}]}}}}},required:["versions","name","identifierSpace","schemaSpace"]},he={$schema:"http://json-schema.org/schema#",$id:"https://reconciliation-api.github.io/specs/latest/schemas/reconciliation-result-batch.json",type:"object",description:"This schema can be used to validate the JSON serialization of any reconciliation result batch.",patternProperties:{"^.*$":{type:"object",properties:{result:{type:"array",items:{type:"object",properties:{id:{type:"string",description:"Entity identifier of the candidate"},name:{type:"string",description:"Entity name of the candidate"},score:{type:"number",description:"Number indicating how likely it is that the candidate matches the query"},features:{type:"array",description:"A list of features which can be used to derive a matching score",items:{type:"object",properties:{id:{type:"string",description:"A unique string identifier for the feature"},value:{description:"The value of the feature for this reconciliation candidate",oneOf:[{type:"boolean"},{type:"number"}]}}}},match:{type:"boolean",description:"Boolean value indicating whether the candiate is a certain match or not."},type:{type:"array",description:"Types the candidate entity belongs to",items:{oneOf:[{type:"object",description:"A type can be given by id and name",properties:{id:{type:"string"},name:{type:"string"}},required:["id"]},{type:"string",description:"Alternatively, if only a string is given, it is treated as the id"}]}}},required:["id","name","score"]}}},required:["result"]}}},de=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(p.a)(t).call(this))).onReconQueryChange=function(t){e.setState({reconQuery:t.currentTarget.value})},e.onReconTypeChange=function(t){e.setState({reconType:t.currentTarget.value})},e.onCustomTypeChange=function(t){e.setState({reconCustomType:t})},e.onReconPropertiesChange=function(t){e.setState({reconProperties:t})},e.onReconLimitChange=function(t){e.setState({reconLimit:t.currentTarget.value})},e.onSubmitReconciliation=function(t){(t.preventDefault(),e.props.service&&e.props.service.endpoint)&&(e.setState({reconResults:"fetching"}),e.props.service.getFetcher()(e.formulateQueryUrl(),{timeout:2e4}).then(function(e){return e.json()}).then(function(t){return e.setState({reconResults:t.q0.result,reconResponseValidationErrors:e.validateServiceResponse(e.reconResponseSchema,t)})}).catch(function(t){e.setState({reconError:t.message,reconResults:"failed"})}))},e.state={reconQuery:"",reconType:"no-type",reconCustomType:void 0,reconProperties:[],reconLimit:void 0,reconResponseValidationErrors:[]},e.ajv=new pe.a({allErrors:!0}),e.manifestSchema=e.ajv.compile(ue),e.reconResponseSchema=e.ajv.compile(he),e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"validateServiceResponse",value:function(e,t){return e(t)?[]:e.errors.map(function(e){return e.dataPath+" "+e.message})}},{key:"renderQueryResults",value:function(){var e=this;return"fetching"===this.state.reconResults?r.a.createElement("div",{className:"resultsPlaceholder"},"Querying the service..."):"failed"===this.state.reconResults?r.a.createElement("div",{className:"resultsPlaceholder"},"Error: ",this.state.reconError):void 0===this.state.reconResults?r.a.createElement("div",null):0===this.state.reconResults.length?r.a.createElement("span",{className:"noResults"},"No results"):r.a.createElement(X.a,null,this.state.reconResults.map(function(t){return r.a.createElement(se,{candidate:t,manifest:e.props.service.manifest})}))}},{key:"renderReconResponseValidationErrors",value:function(){return 0===this.state.reconResponseValidationErrors.length?r.a.createElement("div",null):r.a.createElement(H.a,{bsStyle:"warning"},r.a.createElement("strong",null,"Validations error for reconcilation response"),r.a.createElement("ul",null,this.state.reconResponseValidationErrors.map(function(e,t){return r.a.createElement("li",{key:t},e)})))}},{key:"renderManifestValidationErrors",value:function(){var e=this.props.service.manifest,t=this.validateServiceResponse(this.manifestSchema,e);return 0===t.length?r.a.createElement("div",null):r.a.createElement(H.a,{bsStyle:"warning"},r.a.createElement("strong",null,"Validation errors for service manifest"),r.a.createElement("ul",null,t.map(function(e,t){return r.a.createElement("li",{key:t},e)})))}},{key:"formulateReconQuery",value:function(){var e={query:this.state.reconQuery};return"custom-type"===this.state.reconType&&void 0!==this.state.reconCustomType?e.type=this.state.reconCustomType.id:"no-type"!==this.state.reconType&&(e.type=this.state.reconType),this.state.reconProperties.length>0&&(e.properties=this.state.reconProperties.filter(function(e){return void 0!==e&&e.property&&e.value}).map(function(e){return{pid:e.property.id,v:e.value}})),isNaN(parseInt(this.state.reconLimit))||(e.limit=parseInt(this.state.reconLimit)),e}},{key:"formulateQueryUrl",value:function(){var e=this.props.service.endpoint;if(!e)return"#";var t={queries:JSON.stringify({q0:this.formulateReconQuery()})},n=new URL(e);return Object.keys(t).forEach(function(e){return n.searchParams.append(e,t[e])}),n.toString()}},{key:"renderTypeChoices",value:function(){var e=this,t=this.state.reconType,n=this.defaultTypes.map(function(n){return r.a.createElement(Y.a,{name:"reconcileType",key:"key_"+n.id,value:n.id,checked:t===n.id,onChange:e.onReconTypeChange},n.name,r.a.createElement("br",null),r.a.createElement("span",{className:"reconTypeId"},n.id))});return this.hasTypeSuggest&&n.push(r.a.createElement(Y.a,{name:"reconcileType",key:"custom-type",value:"custom-type",checked:"custom-type"===t,onChange:this.onReconTypeChange},"Custom:",r.a.createElement("div",null,r.a.createElement(ee,{service:this.props.service,entityClass:"type",id:"recon-custom-type-suggest",value:this.state.reconCustomType,onChange:this.onCustomTypeChange})))),n.push(r.a.createElement(Y.a,{name:"reconcileType",key:"no-type",value:"no-type",checked:"no-type"===t,onChange:this.onReconTypeChange},"Reconcile against no particular type")),n}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.renderManifestValidationErrors(),r.a.createElement(P.a,{defaultActiveKey:"reconcile",animation:!1,id:"test-bench-tabs"},r.a.createElement(_.a,{eventKey:"reconcile",title:"Reconcile"},r.a.createElement("div",{className:"tabContent"},r.a.createElement(B.a,{sm:5},r.a.createElement(A.a,{horizontal:!0},r.a.createElement(L.a,{controlId:"reconcileName"},r.a.createElement(B.a,{componentClass:U.a,sm:2},"Name:"),r.a.createElement(B.a,{sm:10},r.a.createElement(z.a,null,r.a.createElement(D.a,{type:"text",placeholder:"Entity to reconcile",value:this.state.reconQuery,onChange:this.onReconQueryChange}),r.a.createElement(z.a.Button,null,r.a.createElement(g.a,{onClick:this.onSubmitReconciliation,type:"submit",bsStyle:"primary",disabled:!this.props.service},"Reconcile"))))),r.a.createElement(L.a,{controlId:"reconcileType"},r.a.createElement(B.a,{componentClass:U.a,sm:2},"Type:"),r.a.createElement(B.a,{sm:10},this.renderTypeChoices())),this.hasPropertySuggest?r.a.createElement(L.a,{controlId:"reconcileProperties"},r.a.createElement(B.a,{componentClass:U.a,sm:2},"Properties:"),r.a.createElement(B.a,{sm:10},r.a.createElement(te,{service:this.props.service,value:this.state.reconProperties,onChange:this.onReconPropertiesChange}))):r.a.createElement("div",null),r.a.createElement(L.a,{controlId:"reconcileLimit"},r.a.createElement(B.a,{componentClass:U.a,sm:2},"Limit:"),r.a.createElement(B.a,{sm:10},r.a.createElement(D.a,{type:"number",placeholder:"Maximum number of candidates",value:this.state.reconLimit,onChange:function(t){return e.onReconLimitChange(t)}}))))),r.a.createElement(B.a,{sm:3},r.a.createElement(ce.a,{theme:{scheme:"monokai",author:"wimer hazenberg (http://www.monokai.nl)",base00:"#000000",base01:"#383830",base02:"#49483e",base03:"#75715e",base04:"#a59f85",base05:"#00ff00",base06:"#f5f4f1",base07:"#f9f8f5",base08:"#f92672",base09:"#fd971f",base0A:"#f4bf75",base0B:"#a6e22e",base0C:"#a1efe4",base0D:"#66d9ef",base0E:"#ae81ff",base0F:"#cc6633"},data:this.formulateReconQuery(),getItemString:function(e,t,n,a){return""},shouldExpandNode:function(e,t,n){return!0},hideRoot:!0}),r.a.createElement("br",null),r.a.createElement("a",{href:this.formulateQueryUrl(),title:"See query results on the service",target:"_blank",rel:"noopener noreferrer"},"View query results on the service"),this.renderReconResponseValidationErrors()),r.a.createElement(B.a,{sm:4},this.renderQueryResults()))),r.a.createElement(_.a,{eventKey:"suggest",title:"Suggest"},r.a.createElement("div",{className:"tabContent"},r.a.createElement(A.a,{horizontal:!0},r.a.createElement(L.a,{controlId:"suggestEntityTestBench"},r.a.createElement(B.a,{componentClass:U.a,sm:1},"Entity:"),r.a.createElement(B.a,{sm:11},r.a.createElement(ee,{service:this.props.service,entityClass:"entity",id:"entity-suggest-test"}))),r.a.createElement(L.a,{controlId:"suggestTypeTestBench"},r.a.createElement(B.a,{componentClass:U.a,sm:1},"Type:"),r.a.createElement(B.a,{sm:11},r.a.createElement(ee,{service:this.props.service,entityClass:"type",id:"type-suggest-test"}))),r.a.createElement(L.a,{controlId:"suggestPropertyTestBench"},r.a.createElement(B.a,{componentClass:U.a,sm:1},"Property:"),r.a.createElement(B.a,{sm:11},r.a.createElement(ee,{service:this.props.service,entityClass:"property",id:"property-suggest-test"})))))),r.a.createElement(_.a,{eventKey:"preview",title:"Preview"},r.a.createElement("div",{className:"tabContent"},r.a.createElement("p",null,"Coming soon"))),r.a.createElement(_.a,{eventKey:"extend",title:"Extend"},r.a.createElement("div",{className:"tabContent"},r.a.createElement("p",null,"Coming soon")))))}},{key:"defaultTypes",get:function(){return this.props.service&&this.props.service.manifest&&this.props.service.manifest.defaultTypes||[]}},{key:"hasTypeSuggest",get:function(){return this.props.service&&this.props.service.manifest&&this.props.service.manifest.suggest&&this.props.service.manifest.suggest.type}},{key:"hasPropertySuggest",get:function(){return this.props.service&&this.props.service.manifest&&this.props.service.manifest.suggest&&this.props.service.manifest.suggest.property}}]),t}(r.a.Component),me=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(p.a)(t).call(this))).onEndpointSelect=function(t){e.setState({service:t,selectedEndpoint:t.endpoint,openTab:"testBench"})},e.onEndpointChange=function(t){e.setState({service:t})},e.handleTabSelect=function(t){e.setState({openTab:t})},e.state={selectedEndpoint:"",service:{},openTab:"servicesList"},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=r.a.createElement("div",null);return this.state.service&&this.state.service.endpoint&&(e=r.a.createElement(de,{service:this.state.service})),r.a.createElement("div",{className:"App",style:{margin:"20px"}},r.a.createElement("h1",null,"Reconciliation service test bench"),r.a.createElement(P.a,{activeKey:this.state.openTab,onSelect:this.handleTabSelect,animation:!1,id:"main-tabs"},r.a.createElement(_.a,{eventKey:"servicesList",title:"Services"},r.a.createElement("div",{className:"tabContent"},r.a.createElement("p",null,"This table lists reconciliation services known to ",r.a.createElement("a",{href:"https://www.wikidata.org/"},"Wikidata")," and indicates which features of the ",r.a.createElement("a",{href:"https://reconciliation-api.github.io/specs/latest/"},"reconciliation API")," they support."),r.a.createElement("p",null,'If you are viewing this app over HTTPS it is likely that reconciliation services using HTTP are blocked as "mixed content". You can disable this protection in your browser to load HTTP reconciliation services.'),r.a.createElement(j,{onSelect:this.onEndpointSelect},r.a.createElement(O,{name:"OpenCorporates",endpoint:"https://opencorporates.com/reconcile",documentation:"https://api.opencorporates.com/documentation/Open-Refine-Reconciliation-API"})))),r.a.createElement(_.a,{eventKey:"testBench",title:"Test bench"},r.a.createElement("div",{className:"tabContent"},r.a.createElement("p",null,"This form lets you test a reconciliation endpoint interactively."),r.a.createElement(F,{onChange:this.onEndpointChange,initialService:this.state.service,key:this.state.selectedEndpoint}),e))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(me,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[246,1,2]]]);
//# sourceMappingURL=main.ab1060de.chunk.js.map